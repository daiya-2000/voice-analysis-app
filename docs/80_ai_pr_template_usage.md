# AI用PRテンプレートの活用方法

## 1. これを入れる理由（AI駆動開発の地雷対策）

AIが作るPRは以下の事故が起きやすい：

- UIから直接Supabase/AI APIを叩く（責務崩壊）
- domain層に外部SDKを入れる（依存方向崩壊）
- AI結果を断定表現にする（UXポリシー違反）
- 「Observer」「Detected Speakers」の概念を混ぜる（仕様崩壊）
- テストを追加しない（品質担保不可）

PRテンプレートは、これらをレビュー時に一瞬で検知するためのチェックリスト。

---

## 2. どう使うと効くか（おすすめ運用）

### 2.1 AIにPR本文まで書かせる
Codex/CodeXに対して、実装後に以下を命令する：

- 変更内容をこのテンプレートに埋めてPR本文を作成
- どの層に何を足したかを列挙
- 仕様ポリシー（推定/傾向、ランキング禁止）に違反していないか自己チェック

→ PRレビューの速度が2〜3倍になる。

---

### 2.2 PRを「小さく」保つための分割軸を固定
このテンプレを使うと、自然にPRが小さくなる。

推奨分割：
- PR1：domain/application/adaptersの骨格（UI最小）
- PR2：UI接続（画面追加、表示のみ）
- PR3：UX文言・表現の調整（ポリシーの最終調整）

---

### 2.3 “AIが間違えやすいチェック項目”を最重要にする
特にこのプロジェクトでは以下が最重要：

- Observer（QR参加）と Detected Speakers（音声検出）の分離
- AI結果の断定禁止（推定/傾向）
- ランキング禁止

テンプレの「4. 仕様の重要ポイント」をレビューの最優先にする。

---

## 3. 実務での流れ（例）

1) AIに実装を依頼
2) AIに `npm test` / `npm run lint` / `npm run typecheck` の実行を促す（手元で）
3) AIにPRテンプレートを埋めさせる
4) 人間はテンプレのチェック欄を中心にレビュー
5) 問題があれば「テンプレの該当欄」を指摘してAIに修正させる

---

## 4. CodeX/Codex向けコピペ指示（PR本文生成用）

以下をAIに貼り付ける：

---
あなたはこのリポジトリのAGENTS.mdとdocs配下の仕様に従って作業しました。
次に、.github/pull_request_template.md の項目をすべて埋めて、PR本文をMarkdownで出力してください。
特に以下を必ず明記してください：
- domain/application/adapters/presentation の変更点
- AI分析ポリシー（推定/傾向、断定禁止、ランキング禁止）に違反していないこと
- Observer と Detected Speakers の分離が守られていること
- テストの追加内容と実行結果
---

この指示で、PRレビューの品質が安定する。
